<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>blak notebook™</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    body {
      font-size: 16px;
      word-wrap: break-word;
      margin: 0;
      padding: 0;
    }

    #terminal {
      width: 50vw; /* Half the screen width */
      max-width: 50vw; /* Maximum width of half the screen */
      position: absolute; /* Fixed positioning from the top left */
      top: 0;
      left: 0;
      white-space: pre-wrap;
      padding: 2rem;
    }

    @media (max-width: 768px) {
      #terminal {
        width: 100vw; /* On mobile, full width of the screen */
        max-width: 100vw; /* Ensure it doesn't exceed the screen width */
        top: 0; /* Ensure it starts from the top of the screen */
        left: 0; /* Ensure it starts from the left of the screen */
        padding: 1rem; /* Optional: adjust padding for smaller screens */
      }
    }

    body {
      background-color: #171f1f;
      color: #F7EDED;
      font-family: 'Courier New', monospace;
      font-size: 16px; 
      line-height: 1.4;
      padding: 0;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .green {
      color: #00cc66;
    }

    .blue-link {
      color: #0357FC;
      text-decoration: none;
    }

    .blue-link:hover {
      color: #BA04A7;
    }

    .cursor {
      display: inline-block;
      width: 1ch;
      color: #00cc66;
    }

    .blink {
      animation: blink 1s steps(1) infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      50.1%, 100% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div id="terminal"></div>

  <script>
    const terminal = document.getElementById('terminal');

    const lines = [
      { text: 'b:\\games\\horror\\document>dir', className: 'green' },
      { text: '............................' },
      { text: '???,??? bytes [document.rar]' },
      { text: 'blak notebook™ © 2025 [game]' },
      { text: 'analog horror document ttrpg' },
      { text: '............................' },
      { text: 'download_document.rar  [ ↓ ]', className: 'blue-link' },
      { text: '............................' }
    ];

    const downloadHref = "https://www.dropbox.com/scl/fi/f5iebmpz1u4no4w8kjdvb/document.rar?rlkey=yew6c7vpnhhgzjc313i6nt76p&dl=1";

    let i = 0;
    let glitchInterval;

    // Function to simulate a glitch effect on random characters in any line
    function glitchTextEffect(div, originalText) {
  const randomPos = Math.floor(Math.random() * originalText.length);
  const charAtPos = originalText[randomPos];

  // Skip certain characters (e.g., 0, dots, etc.)
  if (charAtPos === '.' || charAtPos === '0') {
    return;  // Skip changing dots and the number 0
  }

  // Randomly choose from uppercase, lowercase, digits, and symbols
  const randomChar = String.fromCharCode(Math.floor(Math.random() * 94) + 33); // ASCII range from 33 (!) to 126 (~)

  const textArray = originalText.split('');
  textArray[randomPos] = randomChar; // Replace character with random character
  div.textContent = textArray.join('');

  const glitchDuration = Math.floor(Math.random() * 1500) + 500; // Random glitch duration
  setTimeout(() => {
    div.textContent = originalText; // Revert to original text after glitch
  }, glitchDuration);
}

    function typeLine({ text, className = '' }, callback) {
      const div = document.createElement('div');
      if (className) div.classList.add(className);
      terminal.appendChild(div);

      let j = 0;
      const interval = setInterval(() => {
        div.textContent += text[j];
        j++;

        if (j >= text.length) {
          clearInterval(interval);
          if (text.includes("download_document.rar")) {
            const a = document.createElement('a');
            a.href = downloadHref;
            a.className = 'blue-link';
            a.textContent = 'download_document.rar  [ ↓ ]';
            div.innerHTML = '';
            div.appendChild(a);
          }
          callback();
        }
      }, 30);
    }

    function typeAllLines() {
      const delayBeforeDownload = 1000;

      if (i < lines.length) {
        setTimeout(() => {
          typeLine(lines[i], () => {
            i++;
            typeAllLines();
          });
        }, (i === 6 ? delayBeforeDownload : 0));
      } else {
        // Create a separate div for b:>_ under the terminal text
        const cursorDiv = document.createElement('div');
        cursorDiv.classList.add('green');  // Set the text color to green

        // Create the static b:>
        const prompt = document.createElement('span');
        prompt.textContent = 'b:>';
        cursorDiv.appendChild(prompt);

        // Create the blinking cursor (_)
        const blinkingCursor = document.createElement('span');
        blinkingCursor.className = 'cursor blink';  // Only _ will blink
        blinkingCursor.textContent = '_';
        cursorDiv.appendChild(blinkingCursor);

        // Append the cursor div under the terminal text
        terminal.appendChild(cursorDiv);
      }
    }

    // Glitch every 5 seconds on all lines (excluding the prompt and cursor)
    function startGlitch() {
      glitchInterval = setInterval(() => {
        const allDivs = terminal.getElementsByTagName('div'); // Get all the divs (lines)
        for (let div of allDivs) {
          if (div.textContent.length > 0 && !div.textContent.includes('b:>') && !div.textContent.includes('_')) {
            glitchTextEffect(div, div.textContent);  // Apply glitch effect on each line except b:> and _ 
          }
        }
      }, 5000);  // Trigger glitch every 5 seconds
    }

    typeAllLines();
    startGlitch();  // Start glitch effect after typing starts
  </script>
</body>
</html>
